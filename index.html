<!DOCTYPE html>
<html>
<head>
<title>Chat App Demo</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Adding bootstrap -->
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- End Bootstrap -->

<script type="text/javascript" src="/socket.io/socket.io.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>

<script type="text/javascript">
	var socket = io.connect('http://localhost:8080');
	var myname = '';
	socket.on('connect', function(){
		myname = prompt('Whats your name?')
		socket.emit('adduser', myname);
		$('#myname').append('@'+ myname);
	});

	// socket.on('alert', function(username, data){
	// 	$('#alert').append(username+' : '+data)
	// });

	socket.on('updatechat', function(username,data){
		$('#conversation').append('<b class="container-fluid">'+username+' : '+data+'<br><br>');
	});

	 socket.on('privatechat', function(uname, data){
	 	$('#pm').append('<b>'+uname+' : '+data+'<br>');
	});

	socket.on('updateusers', function(data) {
		$('#users').empty();
		$.each(data, function(key, value) {
			$('#users').append('<li class="list-group-item">'+key+'</li>');
		});
	});

	$(function() {
		$('#datasend').click(function() {
			var message = $('#data').val();
			$('#data').val('');
			socket.emit('sendchat', message);
		});

		$('#data').keypress(function(e){
			if(e.which==13) {
				$(this).blur();
				$('#datasend').focus().click();
			}
		});

		$('#pmsend').click(function() {
			var uname = $('#to-user').val();
			var pdata = $('#pdata').val();
			$('#to-user').val('');
			$('#pdata').val('');
			socket.emit('privatemsg', uname, pdata);
			$('#pm').append('<b>'+myname+' : '+pdata+'<br>');
		});

		$('#pdata').keypress(function(e){
			if(e.which==13) {
				$(this).blur();
				$('#pmsend').focus().click();
			}
		});
	});

</script>
<link rel="stylesheet" type="text/css" href="style.css">
<style type="text/css">
body {
	/*background-image: url('bg-img.jpg');*/
	background-color: #F0F0F0;
}
#user-list{
	background-color: #00c46c;
	width:300px;
	height: 480px;
	border-radius: 10px
}
.list-group-item{
	background-color: #00c46c;
}

#outer
{
	height: 500px;
	padding: 10px;
}

#connected-users{
/*	height: 370px;
	overflow-y: scroll;*/
}

#user-list{
	overflow:scroll-y;
}

#pm{
	background-color: white;
	height: 78%;
	overflow:scroll-y;
/*	margin-top: 3px;
	margin-bottom: 3px;*/
	border-radius: 10px;
}

#message-box{
	/*background-color: blue;*/
	/*width:300px;*/
	height: 480px;
	border-radius: 10px;
}

#to-user{
	width:100%;
}

#submit-box{
	margin-top: 10px;
}
/*#pdata{
	width: 93%;
}*/
#small-talk{
	margin: 10px;
}
#myname{
	font-size: 1.5em;
	font-weight: bold;
	text-align: center;
	color: white;
	padding: 10px;
}

</style>


</head>
<body style="">


<!-- <div class="container" id="outer" style="background-color:black"> -->
<div class="container" id="outer" >
	<div id="small-talk">
		<h3>Small Talk.</h3>
	</div>
	<div class="container-fluid col-sm-4" id="user-list"  >
		<div class="container-fluid" style="" id="myname"></div>
		<span class="container-fluid" style="" >Connected Users.</span>
		<div id="connected-users" class="container-fluid" >
		<ul id="users" class="list-group" width="250px" ></ul>
		</div>
	</div>

	<div class="container col-sm-8" id="message-box" style="">
		<input class="container-fluid well well-sm" id="to-user" placeholder="Whom do you want to send?" style="" autocomplete="on"/>
			<div id="pm" class="container-fluid" style="">
			</div>
		<div class="input-group col-sm-12" id="submit-box">
		      <input type="text" class="form-control" id="pdata" placeholder="Type your message here...">
		      <span class="input-group-btn">
		      <button class="btn btn-default" id="pmsend" type="button">Send</button>
		      </span>
		</div>

	</div>

</div>
</body>
</html>
